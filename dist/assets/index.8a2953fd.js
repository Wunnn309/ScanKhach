import{r as j,a as o,A as T,_ as k,j as e,b as d,R as B,C as E,c as F,S as v,B as x,F as H,E as N,T as w,D as K,m as p,d as L,L as $,M as O}from"./antd.50632c6c.js";import{D as P,B as _,a as U}from"./zxing.278c431e.js";const X=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const u of n.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function l(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(a){if(a.ep)return;a.ep=!0;const n=l(a);fetch(a.href,n)}};X();var A={},D=j.exports;A.createRoot=D.createRoot,A.hydrateRoot=D.hydrateRoot;var G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 248H728l-32.4-90.8a32.07 32.07 0 00-30.2-21.2H358.6c-13.5 0-25.6 8.5-30.1 21.2L296 248H160c-44.2 0-80 35.8-80 80v456c0 44.2 35.8 80 80 80h704c44.2 0 80-35.8 80-80V328c0-44.2-35.8-80-80-80zm8 536c0 4.4-3.6 8-8 8H160c-4.4 0-8-3.6-8-8V328c0-4.4 3.6-8 8-8h186.7l17.1-47.8 22.9-64.2h250.5l22.9 64.2 17.1 47.8H864c4.4 0 8 3.6 8 8v456zM512 384c-88.4 0-160 71.6-160 160s71.6 160 160 160 160-71.6 160-160-71.6-160-160-160zm0 256c-53 0-96-43-96-96s43-96 96-96 96 43 96 96-43 96-96 96z"}}]},name:"camera",theme:"outlined"},J=G,Q=function(s,l){return o.exports.createElement(T,k({},s,{ref:l,icon:J}))},W=o.exports.forwardRef(Q),S=W,Y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},Z=Y,ee=function(s,l){return o.exports.createElement(T,k({},s,{ref:l,icon:Z}))},te=o.exports.forwardRef(ee),re=te;const ae=()=>{const c=o.exports.useRef(null),[s,l]=o.exports.useState(!1),[i,a]=o.exports.useState([]),[n,u]=o.exports.useState(null),[h,m]=o.exports.useState(!1),[y,f]=o.exports.useState(""),C=o.exports.useRef(null);o.exports.useEffect(()=>{const t=new Map;t.set(P.POSSIBLE_FORMATS,[_.CODE_128]);const r=new U(t);return u(r),()=>{r&&r.reset()}},[]);const z=async()=>{if(!!n){m(!0);try{const t={video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}},audio:!1},r=await navigator.mediaDevices.getUserMedia(t);c.current&&(c.current.srcObject=r,c.current.play(),l(!0),R())}catch(t){t.name==="NotAllowedError"?p.error("Vui l\xF2ng c\u1EA5p quy\u1EC1n truy c\u1EADp camera"):t.name==="NotFoundError"?p.error("Kh\xF4ng t\xECm th\u1EA5y camera"):p.error("L\u1ED7i khi b\u1EADt camera: "+t.message),m(!1)}}},R=async()=>{if(!(!c.current||!n||!s)){try{const t=await n.decodeFromVideoElement(c.current);if(t){const r=t.getText();r!==y&&(f(r),M(r,t.getBarcodeFormat()),p.success(`Scan th\xE0nh c\xF4ng: ${r}`),C.current=setTimeout(()=>{f("")},1e3))}}catch{}s&&c.current&&requestAnimationFrame(R)}},M=(t,r)=>{const g={id:Date.now(),barcode:t,format:r,timestamp:new Date().toLocaleString("vi-VN")};a(b=>[g,...b])},q=()=>{l(!1),c.current&&c.current.srcObject&&(c.current.srcObject.getTracks().forEach(r=>r.stop()),c.current.srcObject=null),m(!1),C.current&&clearTimeout(C.current)},I=()=>{a([]),p.info("\u0110\xE3 x\xF3a t\u1EA5t c\u1EA3 k\u1EBFt qu\u1EA3")},V=()=>{if(i.length===0){p.warning("Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u \u0111\u1EC3 xu\u1EA5t");return}let t=`STT,Barcode,Format,Th\u1EDDi gian
`;i.forEach((g,b)=>{t+=`${b+1},"${g.barcode}","${g.format}","${g.timestamp}"
`});const r=document.createElement("a");r.setAttribute("href","data:text/csv;charset=utf-8,"+encodeURIComponent(t)),r.setAttribute("download",`barcodes_${new Date().getTime()}.csv`),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),p.success("\u0110\xE3 xu\u1EA5t file CSV")};return e("div",{className:"barcode-scanner-container",children:d(B,{gutter:[16,16],children:[e(E,{xs:24,lg:14,children:e(F,{title:d(v,{children:[e(S,{}),e("span",{children:"Camera Scanner"})]}),extra:e(v,{children:s?e(x,{danger:!0,icon:e(re,{}),onClick:q,children:"D\u1EEBng"}):e(x,{type:"primary",icon:e(S,{}),onClick:z,loading:h,children:"B\u1EAFt \u0111\u1EA7u"})}),className:"scanner-card",children:e("div",{className:"video-container",children:s?d(H,{children:[e("video",{ref:c,className:"scanner-video",playsInline:!0}),e("div",{className:"scan-overlay",children:e("div",{className:"scan-line"})})]}):e(N,{description:"Camera ch\u01B0a \u0111\u01B0\u1EE3c b\u1EADt",style:{paddingTop:"100px"}})})})}),e(E,{xs:24,lg:10,children:e(F,{title:d(v,{children:[e("span",{children:"K\u1EBFt qu\u1EA3 Scan"}),e(w,{color:"blue",children:i.length})]}),extra:d(v,{children:[e(x,{type:"primary",size:"small",onClick:V,disabled:i.length===0,children:"Xu\u1EA5t CSV"}),e(x,{danger:!0,icon:e(K,{}),size:"small",onClick:I,disabled:i.length===0,children:"X\xF3a"})]}),className:"results-card",children:e("div",{className:"results-list",children:i.length>0?i.map((t,r)=>e("div",{className:"result-item",children:d(B,{align:"middle",gutter:16,children:[e(E,{span:1,className:"item-number",children:r+1}),d(E,{span:16,children:[e("div",{className:"result-barcode",children:t.barcode}),e("div",{className:"result-time",children:t.timestamp})]}),e(E,{span:7,children:e(w,{color:"green",children:t.format})})]})},t.id)):e(N,{description:"Ch\u01B0a c\xF3 k\u1EBFt qu\u1EA3"})})})})]})})};const ne=()=>{const[c,s]=o.exports.useState([]),[l,i]=o.exports.useState({total:0,unique:0});o.exports.useCallback((n,u,h)=>{const m={id:Date.now(),barcode:n,format:u,timestamp:h};s(y=>{const f=[m,...y];return a(f),f})},[]);const a=n=>{const u=n.length,h=new Set(n.map(m=>m.barcode)).size;i({total:u,unique:h})};return e("div",{className:"barcode-scanner-page",children:e(ae,{})})};const{Header:ce,Content:se,Footer:oe}=$;function ie(){const[c,s]=L.useState("scanner");return d($,{className:"app-layout",children:[d(ce,{className:"app-header",children:[d("div",{className:"app-logo",children:[e(S,{style:{marginRight:10}}),e("span",{children:"ScanKhach - Barcode Scanner"})]}),e(O,{theme:"dark",mode:"horizontal",selectedKeys:[c],onClick:l=>s(l.key),style:{flex:1},children:e(O.Item,{icon:e(S,{}),children:"Scanner"},"scanner")})]}),e(se,{className:"app-content",children:c==="scanner"&&e(ne,{})}),d(oe,{className:"app-footer",children:[e("p",{children:"\xA9 2026 ScanKhach - Barcode Scanner Application"}),e("p",{style:{marginTop:10,fontSize:12,color:"#666"},children:"S\u1EED d\u1EE5ng @zxing/browser \u0111\u1EC3 qu\xE9t m\xE3 barcode 128 b\u1EB1ng camera \u0111i\u1EC7n tho\u1EA1i"})]})]})}A.createRoot(document.getElementById("root")).render(e(L.StrictMode,{children:e(ie,{})}));
